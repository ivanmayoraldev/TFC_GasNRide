import Novedades from '../Home/Novedades.astro';
import Review from './Review.astro';

<section
  id="main"
  class="relative w-full min-h-screen overflow-hidden pt-16 sm:pt-20 md:pt-24"
>
  <div class="relative z-20 flex flex-col items-center justify-center min-h-screen">
    <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Mobile & Tablet Layout -->
      <div class="flex flex-col items-center text-center lg:hidden">
        <div class="space-y-4 mb-8 md:mb-12 px-6 sm:px-8">
          <h1 class="text-5xl sm:text-6xl md:text-7xl font-bold text-black dark:text-white">
            Gas N Ride
          </h1>
          <h3 class="text-xl sm:text-2xl md:text-3xl font-bold text-black dark:text-white">
            Crea <span class="text-span">rutas</span> para tus viajes
          </h3>
          <p class="text-xl sm:text-2xl md:text-3xl font-bold text-black dark:text-white">
            Disfruta de Madrid de la mejor forma con
          </p>
          <span class="text-2xl sm:text-3xl md:text-4xl font-bold text-black dark:text-white">
            Gas N Ride
          </span>
        </div>

        <div class="flex flex-row justify-center items-center gap-4 mb-12 md:mb-16 px-6 sm:px-8 w-full">
          <a
            href="/download"
            class="w-1/2 btn-descargar-bg text-black px-4 sm:px-6 py-3 sm:py-4 rounded-md text-base sm:text-lg md:text-xl font-medium border-2 border-black text-shadow-custom transition transform shadow-md hover:scale-105 text-center"
          >
            Descargar
          </a>
        </div>

        <div class="w-full md:max-w-2xl px-6 sm:px-8">
          <div class="relative">
            <img
              id="theme-image"
              class="w-full h-auto rounded-2xl shadow-xl mb-8"
              src="./imagenprincipal.png"
              alt="Imagen Landing Page"
            />
          </div>
        </div>

        <div class="w-full md:max-w-2xl px-6 sm:px-8 mt-8 lg:hidden">
          <div class="flex flex-col xl:flex-row items-start xl:items-center gap-8 xl:gap-4">
            <div class="w-full xl:w-1/3 relative">
              <svg
                class="absolute left-4 top-1/2 transform -translate-y-1/2 w-6 h-6 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              <input
                type="text"
                id="search-input"
                readonly
                class="w-full h-12 sm:h-14 pl-12 pr-4 rounded-xl bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-base sm:text-lg md:text-xl text-gray-800 dark:text-gray-200 shadow-lg"
                placeholder=""
              />
            </div>

            <div class="w-full xl:w-2/3 flex flex-nowrap sm:flex-wrap overflow-hidden sm:overflow-x-visible justify-start sm:justify-center xl:justify-start items-center gap-4 sm:gap-6">
              <div class="flex sm:hidden animate-scroll">
                <div class="flex gap-4">
                  <img src="/tech/figma.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/astro.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/firebase.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/react.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/kotlin.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/nodejs.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/tailwindCSS.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/figma.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/astro.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/firebase.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/react.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/kotlin.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/nodejs.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                  <img src="/tech/tailwindCSS.png" alt="" class="h-12 w-auto transition transform hover:scale-105 flex-shrink-0" />
                </div>
              </div>
              <div class="hidden sm:flex flex-wrap justify-center xl:justify-start items-center gap-4 sm:gap-6">
                <img src="/tech/figma.png" alt="" class="h-12 sm:h-14 w-auto transition transform hover:scale-105" />
                <img src="/tech/astro.png" alt="" class="h-12 sm:h-14 w-auto transition transform hover:scale-105" />
                <img src="/tech/firebase.png" alt="" class="h-12 sm:h-14 w-auto transition transform hover:scale-105" />
                <img src="/tech/react.png" alt="" class="h-12 sm:h-14 w-auto transition transform hover:scale-105" />
                <img src="/tech/kotlin.png" alt="" class="h-12 sm:h-14 w-auto transition transform hover:scale-105" />
                <img src="/tech/nodejs.png" alt="" class="h-12 sm:h-14 w-auto transition transform hover:scale-105" />
                <img src="/tech/tailwindCSS.png" alt="" class="h-12 sm:h-14 w-auto transition transform hover:scale-105" />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="hidden lg:flex items-start justify-between gap-12">
        <div class="w-1/2 space-y-8">
          <div class="space-y-4">
            <h1 class="text-7xl font-bold text-black dark:text-white">
              Gas N Ride
            </h1>
            <h3 class="text-3xl font-bold text-black dark:text-white">
              Crea <span class="text-span">rutas</span> para tus viajes
            </h3>
            <p class="text-3xl font-bold text-black dark:text-white">
              Disfruta de Madrid de la mejor forma con
            </p>
            <span class="text-4xl font-bold text-black dark:text-white">
              Gas N Ride
            </span>
          </div>

          <div class="flex gap-4">
            <a
              href="/download"
              class="btn-descargar-bg text-black px-8 py-4 rounded-md text-2xl font-medium border-2 border-black text-shadow-custom transition transform shadow-md hover:scale-105"
            >
              Descargar Gas N Ride
            </a>
          </div>

          <div class="flex justify-start items-center gap-6 pt-20">
            <img src="/tech/figma.png" alt="" class="h-14 w-auto transition transform hover:scale-105" />
            <img src="/tech/astro.png" alt="" class="h-14 w-auto transition transform hover:scale-105" />
            <img src="/tech/firebase.png" alt="" class="h-14 w-auto transition transform hover:scale-105" />
            <img src="/tech/react.png" alt="" class="h-14 w-auto transition transform hover:scale-105" />
            <img src="/tech/nodejs.png" alt="" class="h-14 w-auto transition transform hover:scale-105" />
            <img src="/tech/kotlin.png" alt="" class="h-14 w-auto transition transform hover:scale-105" />
            <img src="/tech/tailwindCSS.png" alt="" class="h-14 w-auto transition transform hover:scale-105" />
          </div>
        </div>

        <div class="w-1/2 space-y-8">
          <div class="relative">
            <img
              id="theme-image-desktop"
              class="w-full h-auto rounded-2xl shadow-xl"
              src="./imagenprincipal.png"
              alt="Imagen Landing Page"
            />
          </div>

          <div class="relative w-full">
            <svg
              class="absolute left-4 top-1/2 transform -translate-y-1/2 w-6 h-6 text-gray-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            <input
              type="text"
              id="search-input-desktop"
              readonly
              class="w-full h-14 pl-12 pr-4 rounded-xl bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-2xl text-gray-800 dark:text-gray-200 shadow-lg"
              placeholder=""
            />
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const input = document.getElementById("search-input") as HTMLInputElement;
    const inputDesktop = document.getElementById("search-input-desktop") as HTMLInputElement;
    const texts = ["Madrid", "Municipios", "Gasolineras", "Puntos de InterÃ©s"];
    let currentTextIndex = 0;
    let charIndex = 0;
    let isDeleting = false;
    let delay = 150;

    function type() {
      if (!input || !inputDesktop) return;
      
      const currentText = texts[currentTextIndex];
      if (!isDeleting) {
        input.value = currentText.slice(0, charIndex + 1);
        inputDesktop.value = currentText.slice(0, charIndex + 1);
        charIndex++;

        if (charIndex === currentText.length) {
          isDeleting = true;
          delay = 1000;
        } else {
          delay = 150;
        }
      } else {
        input.value = currentText.slice(0, charIndex - 1);
        inputDesktop.value = currentText.slice(0, charIndex - 1);
        charIndex--;

        if (charIndex === 0) {
          isDeleting = false;
          currentTextIndex = (currentTextIndex + 1) % texts.length;
          delay = 500;
        } else {
          delay = 100;
        }
      }
      setTimeout(type, delay);
    }

    type();

    const themeImage = document.getElementById('theme-image') as HTMLImageElement;
    const themeImageDesktop = document.getElementById('theme-image-desktop') as HTMLImageElement;
    
    if (themeImage && themeImageDesktop) {
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.attributeName === 'data-theme') {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            const newSrc = isDark ? '/Imagen Landing Page - Dark.png' : './imagenprincipal.png';
            themeImage.src = newSrc;
            themeImageDesktop.src = newSrc;
          }
        });
      });

      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['data-theme']
      });
    }
  </script>

  <style>
    @keyframes scroll {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(-50%);
      }
    }

    .animate-scroll {
      animation: scroll 20s linear infinite;
      width: max-content;
    }

    .animate-scroll:hover {
      animation-play-state: paused;
    }

    .overflow-hidden::-webkit-scrollbar {
      display: none;
    }

    .overflow-hidden {
      -ms-overflow-style: none; 
      scrollbar-width: none; 
    }
  </style>
</section>

